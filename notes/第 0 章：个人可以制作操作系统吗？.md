# 第 0 章：个人可以制作操作系统吗？

## 一、核心结论
个人**可以制作操作系统**，但并非Windows、macOS、Linux这类数千万行代码的大型系统，而是功能简易但完整的小型操作系统（如Linux 0.01仅1万多行代码，《30天自制操作系统》中的系统约40KB，本书目标制作的MikanOS），可体验从底层到应用的完整开发流程。

## 二、操作系统的核心认知
### 1. 定义：无统一标准
- 本质：只要创造者及周围人认可，功能简单的软件也可称为操作系统，难以找到所有操作系统的通用特征。
- 流行系统（Windows、macOS、Linux）的共性功能（三大核心方面）：
  | 功能维度 | 核心作用 | 具体说明 |
  |----------|----------|----------|
  | 应用接口方面 | 简化硬件操作，提供统一抽象 | 操作系统接管外部设备（HDD、SSD、鼠标等）的复杂控制，向应用提供简化接口，隐藏硬件细节，支持不同设备通过同一接口使用（如文件读写接口适配各类存储设备） |
  | 计算资源分发者方面 | 合理分配有限资源 | 管理CPU、内存、外部设备等资源，避免单个应用垄断，确保多个应用与操作系统并行运行（如防止视频编码时鼠标卡顿） |
  | 人看到的接口方面 | 提供通用交互体验 | 为应用统一菜单（如“文件-保存”）、快捷键（Ctrl+C/Ctrl+V），降低用户操作复杂度 |

### 2. 关键接口：POSIX
- 定义：可移植操作系统接口，类UNIX系统广泛采用，涵盖C函数、文件系统、进程等规范。
- 作用：统一接口规范后，应用可跨操作系统运行，操作系统可适配不同硬件（x86、ARM等）。
- 本书立场：MikanOS不强制兼容POSIX，但支持用户尝试兼容拓展。

## 三、自制操作系统的方法与步骤
### 1. 制作方法选择
| 方法类型 | 特点 | 本书选择 |
|----------|------|----------|
| 修改现有操作系统（如Linux、macOS） | 仅能体验部分流程，无法了解系统全貌 | 不选择 |
| 完全自制 | 体验从开机引导到应用运行的完整流程，理解计算机内部结构与系统工作原理 | 选择 |

### 2. 核心开发条件
- 开发/测试环境：
  - 开发机：推荐Linux系统（本书基于Ubuntu 18.04测试），Windows用户可通过WSL（Windows Subsystem for Linux）运行Linux。
  - 测试方式：① 实体测试机（2012年后发售机型大概率兼容）；② 模拟器（推荐QEMU，无需重启，便捷安全）。
- 工具：
  - 编辑器：无强制要求（如Vim），能生成可执行文件即可。
  - 编译器：推荐Clang（+LLVM），也可使用GCC。
  - 存储介质：U盘（用于存放引导加载器等文件）。

### 3. 整体开发流程
1. 制作引导加载器：需适配UEFI（替代传统BIOS），实现程序从存储设备（HDD/SSD）加载到主内存的功能。
2. 核心功能开发：依次实现图形显示（像素绘制、文本/图形渲染）、中断机制（处理鼠标/键盘等设备事件）、内存管理（分页管理，分配空闲内存）、窗口系统（处理图层叠加，优化绘制效率）。
3. 基础机制完善：定时器（支持定时任务、抢占式多任务）、输入输出（键盘键码处理、终端CLI）、文件系统（管理存储设备，实现文件命名与寻址）。
4. 应用与拓展：开发系统调用（限制应用与系统的交互，保障安全）、文件读写接口（通过文件描述符操作文件）、日文支持（基于FreeType/TrueType字体）、应用间通信（组合小型应用完成复杂任务）。

## 四、学习与实践建议（享受自制乐趣）
### 1. 高效学习方法
- “抄经”：手动输入示例代码（而非复制粘贴），便于关注细节，深刻理解代码逻辑。
- 主动拓展：修改书中未涉及的功能，探索未知领域，深化知识掌握。

### 2. 问题解决途径
- 官方支持：访问本书支持站点（GitHub Issues/Wiki），提问或发布学习笔记、修改成果。
- 社区交流：加入osdev-jp社区，与其他自制操作系统（个人计算机/嵌入式设备方向）的开发者交流。

### 3. 核心挑战与乐趣
- 挑战：操作系统与硬件直接相关，MikanOS可能无法在部分设备上启动，需排查硬件兼容问题并修改。
- 乐趣：从底层构建支撑系统的机制，见证简单功能逐步拓展为完整系统，以及应用范围不断扩大的过程。

## 五、MikanOS的核心全貌
- 目标特性：UEFI启动、Intel 64位模式运行、分页内存管理、支持USB 3.0、具备文件系统与GUI。
- 关键模块：引导加载器→图形/中断/内存管理→窗口/定时器→终端/文件系统→应用/系统调用→文件操作/日文支持/应用间通信。
- 最终效果：可运行简单应用、支持文件管理、显示图片与日文、提供交互终端，具备基础操作系统的核心能力。